<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>"MixMustR: a Multi-Tracer Bayesian Approach to Unravelling the Sources of Organic Mixtures" • MixMustR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="" mixmustr: a multi-tracer bayesian approach to unravelling the sources of organic mixtures>
<meta property="og:description" content="This is a flexible Bayesian mixture model package written in the probabilistic programming language Stan (&lt;https://mc-stan.org/&gt;) for R (&lt;https://www.r-project.org/&gt;). It estimates source mixing proportions by incorporating simultaneous likelihood evaluation from two independent data streams collected from the mixture of interest: one obtained from chemical tracers/biomarkers (i.e., a single tracer measurement per observation, e.g., from stable isotopes and fatty acids), and another yielding source composition (e.g., based on eDNA). `MixMustR` also allows for the estimation of an additional, unsampled source component to partially relax the assumption that the mixing proportions from all samples sources should sum up to 1. `MixMustR` should have wide applicability in ecological studies, particularly given the growing usage and availability of eDNA and metabarcoding methods to understand carbon source-sink dynamics as well as trophic interactions.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">MixMustR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/introduction.html">Introduction to MixMustR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/open-aims/MixMustR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="mixmustr-">MixMustR <img src="reference/figures/logo.png" width="180" alt="MixMustR Logo" align="right"><a class="anchor" aria-label="anchor" href="#mixmustr-"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>MixMustR</code> is a flexible Bayesian mixture model package written in the probabilistic programming language <a href="https://mc-stan.org/" class="external-link">Stan</a> for <a href="https://www.r-project.org/" class="external-link">R</a>. It estimates source mixing proportions by incorporating simultaneous likelihood evaluation from two independent data streams collected from the mixture of interest (Fig. 1a–b): one obtained from chemical tracers/biomarkers (i.e., a single tracer measurement per observation, e.g., from stable isotopes and fatty acids), and another yielding source composition (e.g., based on eDNA). <code>MixMustR</code> also allows for the estimation of an additional, unsampled source component to partially relax the assumption that the mixing proportions from all samples sources should sum up to 1. <code>MixMustR</code> should have wide applicability in ecological studies, particularly given the growing usage and availability of multiple tracers spanning traditional stable isotopes and eDNA to understand carbon source-sink dynamics (<a href="https://aslopubs.onlinelibrary.wiley.com/doi/10.1002/lno.10499" class="external-link">Reef <em>et al.</em> 2018</a>, <a href="https://aslopubs.onlinelibrary.wiley.com/doi/10.1002/lno.11579" class="external-link">Ortega <em>et al.</em> 2020</a>, <a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecm.1366" class="external-link">Queirós <em>et al.</em> 2019</a>), and a mixture of stables isotope, fatty acids and eDNA to unravel trophic interactions (e.g., <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12869" class="external-link">Nielsen <em>et al.</em> 2017</a>, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/mec.16688" class="external-link">Hoenig <em>et al.</em> 2022</a>).</p>
<p align="center">
<img src="reference/figures/diagram.png" width="800/"></p>
<p><strong>Figure 1:</strong> <code>MixMustR</code> input data and framework. <code>MixMustR</code> relies on two independent data streams that are collected from the same <em>N</em> samples. a) the first stream (blue panel) is characterised by the canonical chemical tracer/biomarker (e.g., stable isotope, fatty acid) dataset, whereby a mixture measurement is obtained for every <em>k</em><sup>th</sup> tracer and <em>n</em><sup>th</sup> observation. The original sources of such mixtures are unknown, and based on domain knowledge researchers often assume that they come from <em>J</em> likely sources—here represented by hypothetical autotrophic carbon sources within the dashed bubble. However, there is a possibility that at least one additional source (the question mark) is not comprised in the <em>J</em> set of sources. b) The second stream (yellow panel) is yielded by community composition datasets which can be transformed to mixing proportions, such as those obtained via eDNA or metabarcoding techniques. This stream of information can reveal mixture sources beyond the original <em>J</em> sources considered by researchers, and <code>MixMustR</code> leverages that information by combining those additional sources into one single <em>unsampled</em> source, which would amount to the question mark in the first data stream. Given these data, the user can choose among eight model variants based on three choices (c—e, see below for more explanations).</p>
</div>
<div class="section level2">
<h2 id="model-variants">Model variants<a class="anchor" aria-label="anchor" href="#model-variants"></a>
</h2>
<p><code>MixMustR</code> currently allows for eight model variants which result from three user-driven binary choices: 1) should the model only ingest the mean sampled-source tracer signatures (equivalent to “residual-only error” structure of the widely-used <a href="https://github.com/brianstock/MixSIAR" class="external-link">MixSIAR</a>) or should it incorporate their uncertainty based on user-provided mean, variance and sample size information (equivalent to “process error” structure of MixSIAR, Fig. 1c); 2) should the unsampled-source tracer signatures be fixed at the mean across all sampled sources, or should they rather be estimated based on a prior informed by the mean and variance across the sampled tracer signatures? (Fig. 1d) and 3) should all observations be treated as independent or should the model include a hierarchical grouping structure? (Fig. 1e).</p>
</div>
<div class="section level2">
<h2 id="synthetic-datasets">Synthetic datasets<a class="anchor" aria-label="anchor" href="#synthetic-datasets"></a>
</h2>
<p><code>MixMustR</code> comes with two synthetic mixture datasets, <code>synthetic_df_convergent</code> and <code>synthetic_df_divergent</code>. Both are anchored to empirical values of stable isotopes and fatty acids for a range of plant carbon sources in marine soils. They are hierarchical in structure and simulate an unbalanced design (identical between both datasets) that would be typical of an ecological field sampling design. They differ in their discrepancy between the underlying mixing proportions between data streams 1 and 2, with <code>synthetic_df_convergent</code> exhibiting little difference, whereas <code>synthetic_df_divergent</code> exhibits larger difference:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(MixMustR)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>mus <span class="ot">&lt;-</span> tracer_parameters<span class="sc">$</span>mus</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">compare_mixing_proportions</span>(synthetic_df_divergent, synthetic_df_convergent, mus)</span></code></pre></div>
<p align="center">
<img src="reference/figures/comp_fig.png" width="800/"></p>
<p>Although in real applications the user is unlikely to know the underlying mixing proportion of data stream 1, these synthetic datasets are useful to test the ability of the model variants (see above) to retrieve the underlying mixture proportions, and the package offers simple summary and visualisation functions for diagnostics.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The current development version can be downloaded from GitHub via</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"remotes"</span>)) {</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>}</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"open-aims/MixMustR"</span>, <span class="at">ref =</span> <span class="st">"main"</span>)</span></code></pre></div>
<p>Because <code>MixMustR</code> is based on <a href="https://mc-stan.org/" class="external-link">Stan</a>, a C++ compiler is required. The program <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a> comes with a C++ compiler for Windows. On Mac, you should install Xcode. See the prerequisites section on this <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started" class="external-link">link</a> for further instructions on how to get the compilers running.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>See package documentation and online vignettes for full explanation of expected structure of input variables.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(MixMustR)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># As an example, we pick mixmustr_models[6, ] because it runs quickest. It is</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># non-hierarchical and does not estimate (un)sampled tracer signatures.</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>model_fits <span class="ot">&lt;-</span> <span class="fu">run_mixmustr_models</span>(</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  mixmustr_models[<span class="dv">6</span>, ], synthetic_df_convergent, tracer_parameters,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">sigma_ln_rho =</span> <span class="fl">0.1</span>, <span class="at">iter =</span> <span class="fl">1e4</span>, <span class="at">warmup =</span> <span class="fl">5e3</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># then visualise a particular output</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">make_post_prop_long</span>(model_fits[[<span class="dv">1</span>]]<span class="sc">$</span>model, tracer_parameters<span class="sc">$</span>mus,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                    synthetic_df_convergent, <span class="at">target =</span> <span class="st">"df_stream_2"</span>, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="fu">plot_multiple_faceted_scatter_avg</span>() <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Observed (simulated) from eDNA (data stream 2)"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Model fit performance mixing proportions"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Synthetic dataset of high agreement"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-information">Further Information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p><code>MixMustR</code> is provided by the <a href="https://www.aims.gov.au/" class="external-link">Australian Institute of Marine Science</a> under the MIT License (<a href="https://opensource.org/license/mit" class="external-link">MIT</a>).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/open-aims/MixMustR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/open-aims/MixMustR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MixMustR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Diego R. Barneche <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4568-2362" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Chritopher J. Fulton <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1140-1999" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://github.com/open-aims/MixMustR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/open-aims/MixMustR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://choosealicense.com/" class="external-link"><img src="https://img.shields.io/badge/license-MIT%20+%20file%20LICENSE-lightgrey.svg" alt="license"></a></li>
<li><a href="https://github.com/open-AIMS/MixMustR/issues/new" class="external-link"><img src="https://img.shields.io/badge/Ask%20us-anything-1abc9c.svg" alt="Ask Us Anything !"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Diego R. Barneche, Chritopher J. Fulton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
